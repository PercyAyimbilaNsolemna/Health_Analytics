QUESTION 2: Top Diagnosis-Procedure Pairs

SQL Query:
SELECT
    d.icd10_code,
    pr.cpt_code,
    COUNT(DISTINCT e.encounter_id) AS encounter_count
FROM encounter_diagnoses ed
JOIN diagnoses d
    ON ed.diagnosis_id = d.diagnosis_id
JOIN encounter_procedures ep
    ON ed.encounter_id = ep.encounter_id
JOIN procedures pr
    ON ep.procedure_id = pr.procedure_id
JOIN encounters e
    ON e.encounter_id = ed.encounter_id
GROUP BY
    d.icd10_code,
    pr.cpt_code
ORDER BY
    encounter_count DESC;

SCHEMA ANALYSIS:
TABLES JOINED: encounter_diagnoses, diagnoses, encounter_procedures, procedures, encounters
Number of joins: 4

PERFORMANCE:
EXECUTION TIME: 0.446 ms

ESTIMATED ROWS SCANNED: 61 (Detailed access types in the notebook)

ESTIMATED COST: 27

BOTTLENECKS IDENTIFIED:
1. Many-to-Many Join Explosion

    One encounter can have:

        Multiple diagnoses

        Multiple procedures

    Joining them before aggregation creates a Cartesian multiplication per encounter

    Example:

    5 diagnoses × 4 procedures → 20 rows per encounter
