QUESTION 4: Revenue by Specialty & Month

SQL QUERY: 
            SELECT
                DATE_FORMAT(b.claim_date, '%Y-%m') AS claim_month,
                s.specialty_name,
                SUM(b.allowed_amount) AS total_allowed_amount
            FROM billing b
            JOIN encounters e
                ON b.encounter_id = e.encounter_id
            JOIN providers p
                ON e.provider_id = p.provider_id
            JOIN specialties s
                ON p.specialty_id = s.specialty_id
            GROUP BY
                claim_month,
                s.specialty_name
            ORDER BY
                total_allowed_amount DESC


SCHEMA ANALYSIS:


TABLES JOINED: billing, encounters, providers, specialties
                

NUMBER OF JOINS: 3
                    
PERFORMANCE METRICS:

ESTIMATED EXECUTION TIME: 0.1 ms

ESTIMATED ROWS SCANNED: 21 (Detailed access types in the notebook)

ESTIMATED QUERY COST: 7.95


BOTTLENECK IDENTIFIED:
1. Full Table Scan on billing

    What this means

        MySQL reads every row in the billing table.

        It does this before grouping or summing.

    Why this is a bottleneck

    1. As billing grows, scanning the entire table gets slower.

    2. There is no shortcut because:

        Not filtering by date

        No useful index can be used